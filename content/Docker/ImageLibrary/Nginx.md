## Веб-сервер Nginx

Скачать и запустить Nginx
```shell
docker run -d --name my-nginx -p 80:80 nginx:alpine
```

Проверить работоспособность контейнера командой:
```shell
curl http://localhost
```

[Или запустить в браузере: http://localhost](http://localhost)

> Важно понимать, что из одного образа можно создать несколько контейнеров!

Чтобы создать и запустить ещё один контейнер `nginx:alpine`, надо указать другое имя и порт, например:
```shell
docker run -d --name my-nginx-copy -p 81:80 nginx:alpine
```

[Или запустить в браузере: http://localhost:81](http://localhost:81)

### Полезные команды для работы с контейнерами и образами на примере Nginx

#### Показать запущенные контейнеры
```shell
docker ps
```

#### Подробная информация о контейнере
```shell
docker inspect my-nginx
```

#### Остановить контейнер
```shell
docker stop my-nginx
```

#### Показать все контейнеры, в т.ч. остановленные
```shell
docker ps -a
```

#### Запустить остановленный
```shell
docker start my-nginx
```

#### Перезапустить контейнер
```shell
docker restart my-nginx
```

#### Показать логи
```shell
docker logs my-nginx
```
```shell
docker logs -f my-nginx  # в реальном времени
```

> Чтобы выйти из режима просмотра логов, нужно выполнить `Ctrl+C`

#### Войти в контейнер
```shell
docker exec -it my-nginx /bin/sh
```

> Важно понимать, что внутри Docker-контейнера как правило какой-нибудь небольшой Linux!

#### Получить ин-фу по ОС контейнера
```shell
cat /etc/os-release
```
Показать процессы внутри контейнера
```shell
top
```

> Чтобы выйти из top, нужно выполнить `Q`

> т.к. это какой-то Linux, то можно попробовать повыполнять другие команды из Linux

Установить fastfetch (например)
```shell
apt install fastfetch
```
после установки выполнить команду:
```shell
fastfetch
```

> Таким образом вы получаете в контейнере маленькую копию Linux, с которым можно работать.

Чтобы выйти из контейнера, следует выполнить:
```shell
exit
```

#### Скопировать файл из контейнера
```shell
docker cp my-nginx:/etc/nginx/nginx.conf ./nginx.conf
```

#### Мониторинг контейнеров
```shell
docker stats
```

> Вывод ин-фы мониторинга обновляется каждые 2 сек.!

Выйти из мониторинга по `Ctrl+C`

#### Мониторинг без постоянного обновления (однократный вывод)
```shell
docker stats --no-stream
```
```shell
docker stats $(docker ps -q)
```

### Удаление контейнера и образа на примере Nginx

- Остановить указанный контейнер
- Получить ID указанного контейнера
- Удалить остановленный контейнер
- Получить ID указанного образа
- Удалить указанный образ

#### Удалить контейнер
```shell
docker rm my-nginx
```

Удалить контейнер и его volume (если есть)
```shell
docker rm -v my-nginx
```

> volume - это тома с данными

или удалить все остановленные (неиспользуемые) контейнеры:

```shell
docker container prune
```

> docker container prune может удалить все остановленные контейнеры!

#### Удалить образ

- Получить id указанного образа
- Удалить указанный образ

```shell
docker rmi
```

```shell
docker image prune
```